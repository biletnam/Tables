var User = require('backend/models/user').User;
var AuthError = require('backend/models/user').AuthError;

var async = require('async');
exports.get = function(req, res, next) {
    // res.send(send_data);
};

exports.post = function(req, res, next) {
    var send_data = {};

    var username = req.body.name;
    var password = req.body.password;
    User.authorize(username, password, function(err, user) {
        if (err) {
            res.send({ err : err.message});
            // console.info(err.message);
            if (err instanceof AuthError) {
                return ;//next(new HttpError(403, err.message));
            } else {
                return next(err);
            }
        };
        // req.session.user = 11111;
        // console.info(username);
        req.session.user = user._id;
        send_data = { user : username };
        res.send(send_data);

    });
    //console.info(username);


};